<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <link rel="stylesheet" href="https://courses-at-nju-by-hfwei.github.io/cpl-lectures/node_modules/reveal.js-plugins/chalkboard/style.css">
    <script src="https://courses-at-nju-by-hfwei.github.io/cpl-lectures/node_modules/reveal.js-plugins/chalkboard/plugin.js"></script> 
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
 
    <script>
const copyButtonLabel = "Copy Code";

// use a class selector if available
let blocks = document.querySelectorAll("pre");

blocks.forEach((block) => {
  // only add button if browser supports Clipboard API
  if (navigator.clipboard) {
    let button = document.createElement("button");

    button.innerText = copyButtonLabel;
    block.appendChild(button);

    button.addEventListener("click", async () => {
      await copyCode(block);
    });
  }
});

async function copyCode(block) {
  let code = block.querySelector("code");
  let text = code.innerText;

  await navigator.clipboard.writeText(text);
}
    </script>
      <style>
        body {counter-reset:section;}
        h1 {counter-reset:subsection;font-size:x-large;}
        h2 {font-size: large;}
        
        h1:before {
        counter-increment:section;
        content:counter(section) ". ";
            font-weight:bold;
            font-size: x-large;
        }
        h2:before {
        counter-increment:subsection;
        content:counter(section) "." counter(subsection) " ";
        font-size: large;
        }
        html, body {
            margin: 5%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 500;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
        } 

        pre {
            font-family: 'Courier New', Courier, monospace;
        } 
        div{
            max-width: 100%;
            overflow: auto;
            
        }
        .navbar {
            overflow: hidden;
            background-color: #333;
            position: fixed; /* Set the navbar to fixed position */
            top: 0; /* Position the navbar at the top of the page */
            width: 100%; /* Full width */
        }

        img {
        max-width: 80%;
        height: auto;
        }
        .navbar a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

        a {
            color: #148bca;
            text-align: center;
            padding-left: 2px;
            padding-right: 2px;
            text-decoration: none;
        }

        p.hidden {
          overflow: hidden;
        }

    </style>
  </head>
  <body>
    
    <div class="navbar">
        <a href="https://shzaiz.github.io">AUG's Wiki</a>
        <a href="index.html"> ↑ Back to contents</a>
    </div>

    <div class="toc"></div>
    <a id="toc-button"><i class="far fa-bookmark"></i></a>
    <p>$$
\Huge \left[\left[\sum\right]_{}\right]\\
\small\textbf{etoneWiki}
$$</p>
<p>$$
\huge \textbf{Pólya&#x27;s theory of counting}\\
\small \texttt{by etone on Combinatorial Mathematics}\\
\texttt{Spring, 2015 at Nanjing University}
$$</p>
<blockquote>
<p>Contents
[toc]{level: [1,2,3,4,5]}</p>
</blockquote>
<h1>Groups</h1>
<p>A group  \((G,\cdot)\)  is set  \(G\)  along with a binary operator  \(\cdot\)  which satisfies the following axioms:</p>
<ul>
<li><strong>closure</strong>:  \(\forall g,h\in G, g\cdot h \in G\) ;
associativity:  \(\forall f,g,h\in G, f\cdot(g\cdot h)=(f\cdot g)\cdot h\) ;</li>
<li><strong>identity</strong>: there exists a special element  \(e\in G\) , called the identity, such that  \(e\cdot g=g\)  for any  \(g\in G\) ;</li>
<li><strong>inverse</strong>:  \(\forall g\in G\) , there exists an  \(h\in G\)  such that  \(g\cdot h=e\) , and we denote that  \(h = g^{ − 1}\) .</li>
</ul>
<h2>Permutation groups</h2>
<p>A permutation is a bijection  \(\pi:[n]\xrightarrow[\text{onto}]{\text{1-1}}[n]\) . We can define a natural operator &quot; \(\cdot\) &quot; between permutations by function composition, i.e. for any  \(\pi,\sigma\in S_n\) ,  \((\pi\cdot\sigma)(i)=\pi(\sigma(i))\)  for all  \(i\in[n]\) .</p>
<p><strong>Symmetric group  \(S_n\) </strong>
Let  \(S_n\)  denote the set of all permutations of  \([n]\) . It is easy to verify that  \(S_n\)  together with function composition  \(\cdot\)  form a group. This group is called the symmetric group on  \(n\)  elements.</p>
<p>Subgroups of  \(S_n\)  are called <strong>permutation groups</strong>. The most basic permutation group is  \(S_n\)  itself (since a group is a subgroup of itself). Besides it, there are several typical permutation groups related to natural symmetric operations.</p>
<p><strong>Cyclic group  \(C_n\) </strong></p>
<p>Given a permutation  \(\pi\in S_n\) , denote that
$$\pi^t=\underbrace{\pi\cdot\pi\cdots\pi}_t,$$
and  \(π^0 = e\)  is the identity.
We define a special permutation  \(\sigma\,\)  as that  \(\sigma(i)=(i+1)\bmod n\,\)  for any  \(i\) , and let  \(C_n=\{\sigma^t\mid t\ge 0\}\) . We say that  \(C_n\)  is generated by the permutation  \(σ\) . It is easy to verify that  \(C_n\)  is a subgroup of  \(S_n\) . The group  \(C_n\)  is called the <strong>cyclic group</strong> of order  \(n\) , which is the group formed by all <strong>rotational symmetries</strong> of a regular polygon of  \(n\)  sides.
It is easy to see that  \(| C_n | = n\) , that is, there are n rotations of a regular  \(n\) -gon.</p>
<p><strong>Dihedral group  \(D_n\) </strong>
Define another special permutation  \(\rho\,\)  as that  \(\rho(i)=n-i-1\,\)  for all  \(i\in[n]\) . The <strong>Dihedral group</strong>  \(D_n\)  is obtained by adding  \(ρ\)  into  \(C_n\)  and then take a <em>closure</em> (under operations of &quot; \(\cdot\) &quot;). This group is the group of symmetries, including <strong>rotations</strong> as well as <strong>reflections</strong>, of a regular polygon of  \(n\)  sides.
It is an exercise to check that  \(| D_n | = 2n\) .</p>
<h3>Cycle decomposition</h3>
<p>A permutation  \(\pi:[n]\xrightarrow[\text{onto}]{\text{1-1}}[n]\)  can be written in the following form:</p>
<p>$$\begin{pmatrix}
1 &amp; 2 &amp; \cdots &amp; n \\
\pi(1) &amp; \pi(2) &amp; \cdots &amp; \pi(n) 
\end{pmatrix}.$$</p>
<p>For example,</p>
<p>$$\begin{pmatrix}
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 \\
3 &amp; 5 &amp; 1 &amp; 2 &amp; 4 
\end{pmatrix}.$$</p>
<p>The permutation can be equivalently described as a composition of a number of <strong>cycles</strong>. For example, in the above permutation, we have two cycles:</p>
<p> \(1\rightarrow 3\rightarrow 1\)  and  \(2\rightarrow5\rightarrow4\rightarrow2\) .
We can denote the permutation by</p>
<p>$$(13)(254).$$</p>
<h2>Group action</h2>
<blockquote>
<p>Definition (group action)
A group action of a group  \(G\)  on a set  \(X\)  is a binary operator:
$$\circ:G\times X\rightarrow X$$
satisfying:
Associativity:  \((g\cdot h)\circ x=g\circ (h\circ x)\)  for all  \(g,h\in G\)  and  \(x\in X\) ;
Identity:  \(e\circ x=x\)  for all  \(x\in X.\) </p>
</blockquote>
<h3>Example: coloring a necklace</h3>
<p>Suppose a necklace is made of  \(n\)  beads, each with one of the  \(m\)  colors. Formally, a necklace is an assignment  \(x:[n]\rightarrow[m]\)  of  \(m\)  colors to  \(n\)  positions. Let  \(X=\{x:[n]\rightarrow[m]\}\)  be the set of all such assignments.</p>
<p>For example, when  \(n = 4\)  and  \(m = 2\) ,  \(X\)  contains all possible  \(2\) -colorings (say red and blue) of  \(4\)  positions.</p>
<p>$$\small X=\{{\color{blue}bbbb}, {\color{blue}bbb}{\color{red}r}, {\color{blue}bb}{\color{red}r}{\color{blue}b}, {\color{blue}bb}{\color{red}rr}, {\color{blue}b}{\color{red}r}{\color{blue}b}{\color{red}r}, {\color{blue}b}{\color{red}rr}{\color{blue}b}, {\color{blue}b}{\color{red}rrr},  {\color{red}r}{\color{blue}bbb}, {\color{red}r}{\color{blue}bb}{\color{red}r}, {\color{red}r}{\color{blue}b}{\color{red}r}{\color{blue}b}, {\color{red}r}{\color{blue}b}{\color{red}rr}, {\color{red}rr}{\color{blue}bb}, {\color{red}rr}{\color{blue}b}{\color{red}r}, {\color{red}rrr}{\color{blue}b}, {\color{red}rrrr}\}
$$</p>
<p>We consider two kinds of symmetric operations on necklaces:</p>
<ul>
<li>Rotation: the corresponding group is the cyclic group  \(C_n\) .</li>
<li>Rotation and reflection: the corresponding group is the dihedral group  \(D_n\) .</li>
</ul>
<p>Mathematically, these operations on necklaces are described as group actions on  \(X\) . Recall that each member  \(x\in X\)  is an  \(m\) -coloring  \(x:[n]\rightarrow[m]\)  of  \(n\)  positions. Suppose the permutation group is  \(G\) , for any  \(\pi\in G\)  and any  \(x\in X\) , the group action  \(\pi\circ x\)  is naturally defined as such:</p>
<p>$$(\pi\circ x)(i)=x(\pi(i)).$$</p>
<h1>Burnside&#x27;s Lemma</h1>
<h2>Orbits</h2>
<blockquote>
<p>Definition
Let  \(G\)  be a permutation group acting on a set  \(X\) . For any  \(x\in X\) . The orbit of  \(x\)  under action of  \(G\) , denoted  \(Gx\) , is defined as
$$Gx=\{\pi\circ x\mid \pi\in G\}.$$</p>
<p>For any  \(x,y,z\in X\) , the followings can be verified for orbits</p>
<ul>
<li>reflexivity:  \(x\in Gx\)  since  \(e\circ x=x\) ;</li>
<li>symmetric: if  \(y\in Gx\)  then there is a  \(\pi\in G\)  such that  \(\pi\circ x=y\) , thus  \(\pi^{-1}\circ y=\pi^{-1}\circ(\pi\circ x) =(\pi^{-1}\cdot \pi)\circ x=e\circ x=x,\)  hence  \(x\in Gy\) ;</li>
<li>transitivity: if  \(y\in Gx\)  and  \(z\in Gy\) , then there exist  \(\pi,\sigma\in G\)  such that  \(\pi\circ x=y\)  and  \(\sigma\circ y=z\) , thus  \((\sigma\cdot \pi)\circ x=\sigma\circ(\pi\circ x)=\sigma\circ y=z\) , hence  \(z\in Gx\) .</li>
</ul>
<p>Therefore,  \(x\in Gy\)  defines an equivalent relation between  \(x\)  and  \(y\) , and orbits partition the set  \(X\) .</p>
</blockquote>
<blockquote>
<p>Example
Back to the example of coloring necklaces.
 \(X\)  contains all possible  \(2\) -colorings (say red and blue) of  \(4\)  positions.
$$\small X=\{{\color{blue}bbbb}, {\color{blue}bbb}{\color{red}r}, {\color{blue}bb}{\color{red}r}{\color{blue}b}, {\color{blue}bb}{\color{red}rr}, {\color{blue}b}{\color{red}r}{\color{blue}bb}, {\color{blue}b}{\color{red}r}{\color{blue}b}{\color{red}r}, {\color{blue}b}{\color{red}rr}{\color{blue}b}, {\color{blue}b}{\color{red}rrr},  {\color{red}r}{\color{blue}bbb}, {\color{red}r}{\color{blue}bb}{\color{red}r}, {\color{red}r}{\color{blue}b}{\color{red}r}{\color{blue}b}, {\color{red}r}{\color{blue}b}{\color{red}rr}, {\color{red}rr}{\color{blue}bb}, {\color{red}rr}{\color{blue}b}{\color{red}r}, {\color{red}rrr}{\color{blue}b}, {\color{red}rrrr}\}$$
We consider the rotations of necklaces. The cyclic group  \(C_4\)  acting on  \(X\)  partitions the  \(X\)  into the following equivalent classes:
$$\begin{aligned}
&amp;\{{\color{blue}bbbb}\},\\
&amp;\{ {\color{blue}bbb}{\color{red}r}, {\color{blue}bb}{\color{red}r}{\color{blue}b}, {\color{blue}b}{\color{red}r}{\color{blue}bb},  {\color{red}r}{\color{blue}bbb}\},\\
&amp;\{ {\color{blue}bb}{\color{red}rr}, {\color{blue}b}{\color{red}rr}{\color{blue}b}, {\color{red}r}{\color{blue}bb}{\color{red}r}, {\color{red}rr}{\color{blue}bb}, \},\\
&amp;\{ {\color{blue}b}{\color{red}r}{\color{blue}b}{\color{red}r}, {\color{red}r}{\color{blue}b}{\color{red}r}{\color{blue}b}\},\\
&amp;\{ {\color{blue}b}{\color{red}rrr}, {\color{red}r}{\color{blue}b}{\color{red}rr}, {\color{red}rr}{\color{blue}b}{\color{red}r}, {\color{red}rrr}{\color{blue}b}\},\\
&amp;\{ {\color{red}rrrr}\}
\end{aligned}$$</p>
</blockquote>
<h2>Invariant sets and stabilizers</h2>
<p>Let  \(G\)  be a permutation group acting on a set  \(X\) . Let  \(\pi\in G, x\in X\) .</p>
<ul>
<li>The <strong>invariant set</strong> of  \(π\) :</li>
</ul>
<p>$$X_\pi=\{x\in X\mid \pi\circ x=x\}.$$</p>
<ul>
<li>The <strong>stabilizer</strong> of  \(x\) :</li>
</ul>
<p>$$G_x=\{\pi\in G\mid \pi\circ x=x\}.$$</p>
<p>There is a beautiful identity for invariant sets and stabilizers.</p>
<blockquote>
<p>Lemma
Let  \(G\)  be a permutation group acting on a set  \(X\) . For any  \(x\in X\) ,
$$|G_x||Gx|=|G|\,.$$</p>
</blockquote>
<blockquote>
<p>Proof.
Recall that the orbit  \(Gx=\{\pi\circ x\mid \pi\in G\}\) . Suppose that  \(Gx=\{x_1,x_2,\ldots,x_t\}\) . Then there exist a set  \(P=\{\pi_1,\pi_2,\ldots,\pi_t\}\)  of permutations such that  \(\pi_i\circ x=x_i\\) , for  \(i=1,2,\ldots,t\) . We construct a bijection between  \(G\)  and  \(P\times G_x\) , which will prove the lemma.</p>
<p>For any  \(\pi\in G\) , it holds that  \(\pi\circ x=x_i\)  for some  \(x_i\) , and since  \(\pi_i\circ x=x_i\) , we have  \(\pi_i\circ x=\pi\circ x\) , hence</p>
<p>$$(\pi_i^{-1}\cdot\pi)\circ x=\pi_i^{-1}\circ(\pi\circ x)=\pi_i^{-1}\circ(\pi_i\circ x)=(\pi_i^{-1}\cdot\pi_i)\circ x=e\circ x=x.$$
Denote that  \(\sigma=\pi_i^{-1}\cdot \pi\) . Then</p>
<p> \(\pi_i\cdot\sigma=\pi_i\cdot(\pi_i^{-1}\cdot\pi)=\pi\) , and
 \(\sigma\circ x=(\pi_i^{-1}\cdot\pi)\circ x=x\) , which implies that  \(\sigma\in G_x\) .
Therefore, each  \(\pi\in G\)  corresponds to a unique pair  \((\pi_i,\sigma)\in P\times G_x\) . We have a 1-1 mapping from  \(G\)  to  \(P\times G_x\) .</p>
<p>For every  \(\pi_i\in P\)  and every  \(\sigma\in G_x\) ,  \(\pi=\pi_i\cdot\sigma\in G\) . We show that this is a 1-1 mapping. Suppose that  \(\pi_i\cdot\sigma=\pi_j\cdot\tau\)  for some  \(\pi_i,\pi_j\in P\)  and  \(\sigma,\tau\in G_x.\)  Then  \((\pi_i\cdot\sigma)\circ x=\pi_i\circ(\sigma\circ x)=\pi_i\circ x=x_i\)  and  \((\pi_j\cdot \tau)\circ x=\pi_j\circ(\tau\circ x)=\pi_j\circ x=x_j\) , which implies  \(x_i = x_j\)  and correspondingly  \(π_i = π_j\) . Since  \(\pi_i\cdot\sigma=\pi_j\cdot\tau\) ,  \(σ = τ\) . Therefore, we show that the mapping is 1-1.</p>
<p>In conclusion, there exists a bijection between  \(P\times G_x\)  and  \(G\) . As a consequence,  \(|Gx||G_x|=|P||G_x|=|P\times G_x|=|G|\) .</p>
<p> \(\square\) </p>
</blockquote>
<h2>Counting orbits</h2>
<blockquote>
<p>Burnside&#x27;s Lemma
Let  \(G\)  be a permutation group acting on a set  \(X\) . The number of orbits, denoted  \(| X / G |\)  , is
$$|X/G|=\frac{1}{|G|}\sum_{\pi\in G}|X_{\pi}|.$$</p>
</blockquote>
<blockquote>
<p>Proof.
Let</p>
<p>$$A(\pi,x)=\begin{cases}1 &amp; \pi\circ x=x,\\ 0 &amp; \text{otherwise.}\end{cases}$$
Basically  \(A(π,x)\)  indicates whether  \(x\)  is invariant under action of  \(π\) . We can think of A as a matrix indexed by  \(G\times X\) . An important observation is that the row sums and column sums of  \(A\)  are  \(| Xπ |\)  and  \(| Gx |\)  respectively, namely,</p>
<p> \(|X_\pi|=\sum_{x\in X}A(\pi,x)\)  and  \(|G_x|=\sum_{\pi\in G}A(\pi,x).\) 
Then a double counting gives that</p>
<p>$$\sum_{\pi\in G}|X_\pi|=\sum_{\pi\in G}\sum_{x\in X}A(\pi,x)=\sum_{x\in X}\sum_{\pi\in G}A(\pi,x)=\sum_{x\in X}|G_x|.$$
Due to the above lemma,  \(|G_x|=\frac{|G|}{|Gx|}\) , thus</p>
<p>$$\sum_{x\in X}|G_x|=\sum_{x\in X}\frac{|G|}{|Gx|}=|G|\sum_{x\in X}\frac{1}{|Gx|}.$$
We may enumerate the  \(x\in X\)  in the sum by first enumerating the orbits and then the elements in each orbit. Denote the orbits by  \(X_1,X_2,\ldots,X_{|X/G|}\) . They forms a partition of  \(X\) , and for any  \(X_i\)  and every  \(x\in X_i, X_i = G_x\) . Thus,</p>
<p>$$|G|\sum_{x\in X}\frac{1}{|Gx|}=|G|\sum_{i=1}^{|X/G|}\sum_{x\in X_i}\frac{1}{|Gx|}=|G|\sum_{i=1}^{|X/G|}\sum_{x\in X_i}\frac{1}{|X_i|}=|G|\sum_{i=1}^{|X/G|}1=|G|{|X/G|}.$$
Combining everything together</p>
<p>$$\sum_{\pi\in G}|X_\pi|=\sum_{x\in X}|G_x|=|G|\sum_{x\in X}\frac{1}{|Gx|}=|G|{|X/G|},$$
which gives us that the number of orbits is</p>
<p>$${|X/G|}=\frac{1}{|G|}\sum_{\pi\in G}|X_\pi|.$$
 \(\square\) </p>
</blockquote>
<h1>Pólya&#x27;s Theory of Counting</h1>
<h2>The cycle index</h2>
<p>Suppose we want to count the number of ways to color  \(n\)  objects using up to  \(m\)  colors, discounting symmetries on the objects described by a group  \(G\) . If a coloring  \(x:[n]\rightarrow[m]\)  is invariant under the action of a permutation  \(\pi\in G\) , then every position in the same cycle of  \(π\)  must have the same color. Therefore, if  \(π\)  is decomposed to  \(k\)  disjoint cycles, the number of colorings invariant under the action of  \(π\)  is  \(| X_π | = m^k\) .</p>
<p>We define the cycle index of a permutation group  \(G\) . For a permutation  \(\pi\in G\)  of  \([n]\) , if  \(π\)  is a product of  \(k\)  cycles, and the ith cycle has length  \(\ell_i\) , let</p>
<p>$$M_\pi(x_1,x_2,\ldots,x_n)=\prod_{i=1}^k x_{\ell_i}.$$</p>
<p>The <strong>cycle index</strong> of G is defined by</p>
<p>$$P_G(x_1,x_2,\ldots,x_n)=\frac{1}{|G|}\sum_{\pi\in G}M_\pi(x_1,x_2,\ldots,x_n).$$
Due to Burnside&#x27;s lemma, the number of equivalent classes of  \(m\) -colorings of  \(n\)  objects, discounting the symmetries described by permutation group  \(G\) , is given by</p>
<p>$$P_G(\underbrace{m,m,\ldots,m}_{n}).$$</p>
<h2>Pólya&#x27;s enumeration formula</h2>
<p>For any tuple  \(\mathbf{v}=(n_1,n_2,\ldots,n_m)\)  of nonnegative integers satisfying that  \(n_1+n_2+\cdots +n_m=n\) , let  \(a_{\mathbf{v}}\)  represent the number of nonequivalent (with respect to a permutation group  \(G\) )  \(m\) -colorings of the  \(n\)  objects, where the  \(i\) th color occurs precisely  \(n_i\)  times. The pattern inventory is the (multivariate) generating function for the sequence  \(a_{\mathbf{v}}\) , defined as</p>
<p>$$F_G(y_1,y_2,\ldots,y_m)=\sum_{\mathbf{v}}a_{\mathbf{v}}y_1^{n_1}y_2^{n_2}\cdots y_m^{n_m},$$</p>
<p>where the sum runs over all  \(\mathbf{v}=(n_1,n_2,\ldots,n_m)\)  satisfying that  \(n_1+n_2+\cdots +n_m=n\)  and  \(n_i\ge 0, 1\le i\le m\) .</p>
<blockquote>
<p>Theorem (Pólya&#x27;s enumeration formula)</p>
<p>Let  \(G\)  be a permutation group. The pattern inventory for the nonequivalent  \(m\) -colorings of  \(n\)  objects under the action of  \(G\)  is:
$$F_G(y_1,y_2,\ldots,y_m)=P_G\left(\sum_{i=1}^m y_i, \sum_{i=1}^m y_i^2,\ldots, \sum_{i=1}^m y_i^n\right).$$</p>
</blockquote>
<blockquote>
<p>Proof.
Let  \(\mathbf{v}=(n_1,\ldots,n_m)\)  be a vector of nonnegative integers satisfying that  \(n_1+\cdots+n_m=n\) , and let  \(a_{\mathbf{v}}\)  represent the number of nonequivalent (with respect to a permutation group  \(G\) )  \(m\) -colorings of the  \(n\)  objects, such that the  \(i\) th color occurs precisely  \(n_i\)  times.</p>
<p>The set of configurations is now</p>
<p>$$X^{\mathbf{v}}=\{x:[n]\rightarrow[m]\mid \forall i\in[m], x^{-1}(i)=n_i\},$$</p>
<p>which contains all  \(m\) -colorings of the  \(n\)  objects such that the  \(i\) th color occurs precisely  \(n_i\)  times, without considering symmetries.</p>
<p>For every  \(\pi\in G\) , the invariant set is now</p>
<p>$$X_\pi^{\mathbf{v}}=\{x\in X^{\mathbf{v}}\mid \pi\circ x=x\}.$$</p>
<p>Claim 1:</p>
<p>$$a_{\mathbf{v}}=\frac{1}{|G|}\sum_{\pi\in G}|X_\pi^{\mathbf{v}}|.$$</p>
<p><em>Proof of Claim 1.</em>
For  \(\mathbf{v}=(n_1,\ldots,n_m)\) , given any permutation  \(\pi\in G, |X^{\mathbf{v}}_\pi|\)  gives the number of colorings  \(x\)  in  \(X^\mathbf{v}\)  invariant under action of  \(π\) , and  \(a_\mathbf{v}\)  is the number of orbits of  \(X^\mathbf{v}\)  induced by the action of permutation group  \(G\) . Due to Burnside&#x27;s lemma,</p>
<p>$$a_{\mathbf{v}}=\frac{1}{|G|}\sum_{\pi\in G}|X_\pi^{\mathbf{v}}|.$$
 \(\square\) </p>
<p>Claim 2:
$$M_\pi\left(\sum_{i=1}^m y_i, \sum_{i=1}^my_i^2,\ldots,\sum_{i=1}^my_i^n\right)=\sum_{\mathbf{v}=(n_1,\ldots,n_m)\atop n_1+\cdots+n_m=n}|X^{\mathbf{v}}_\pi|y_1^{n_1}y_2^{n_2}\cdots y_m^{n_m}.$$</p>
<p><em>Proof of Claim 2.</em>
Supposed that a permutation  \(\pi\in G\)  can be represented as a composition of k cycles, the ith cycle of length  \(\ell_i\) .</p>
<p>$$\pi=\overbrace{\underbrace{(\cdots\cdots)}_{\ell_1}\underbrace{(\cdots)}_{\ell_2}\cdots\underbrace{(\cdots)}_{\ell_k}}^{k \text{ cycles}}$$
The permutation  \(π\)  does not change a coloring  \(x\) , if and only if every cycle of  \(π\)  are assigned the same color. Then  \(|X^{\mathbf{v}}_\pi|\)  equals the number of  \(m\) -colorings of  \(k\)  cycles, where the  \(i\) th cycle is of length  \(\ell_i\) , satisfying that the  \(i\) th color occurs precisely  \(n_i\)  times. The following generalized version of multinomial theorem generates  \(|X^{\mathbf{v}}_\pi|\)  for all  \(\mathbf{v}=(n_1,\ldots,n_m)\) .</p>
<p>$$\begin{aligned}
&amp;\quad\, (y_1^{\ell_1}+y_2^{\ell_1}+\cdots+y_m^{\ell_1})(y_1^{\ell_2}+y_2^{\ell_2}+\cdots+y_m^{\ell_2})\cdots(y_1^{\ell_m}+y_2^{\ell_m}+\cdots+y_m^{\ell_m})\\
&amp;=\sum_{\mathbf{v}=(n_1,\ldots,n_m)\atop n_1+\cdots+n_m=n}|X^{\mathbf{v}}_\pi|y_1^{n_1}y_2^{n_2}\cdots y_m^{n_m}.
\end{aligned}$$
On the other hand,</p>
<p>$$\begin{aligned}
&amp;\quad\, (y_1^{\ell_1}+y_2^{\ell_1}+\cdots+y_m^{\ell_1})(y_1^{\ell_2}+y_2^{\ell_2}+\cdots+y_m^{\ell_2})\cdots(y_1^{\ell_m}+y_2^{\ell_m}+\cdots+y_m^{\ell_m})\\
&amp;=M_\pi\left(\sum_{i=1}^m y_i, \sum_{i=1}^my_i^2,\ldots,\sum_{i=1}^my_i^n\right).
\end{aligned}$$
Therefore,</p>
<p>$$M_\pi\left(\sum_{i=1}^m y_i, \sum_{i=1}^my_i^2,\ldots,\sum_{i=1}^my_i^n\right)=\sum_{\mathbf{v}=(n_1,\ldots,n_m)\atop n_1+\cdots+n_m=n}|X^{\mathbf{v}}_\pi|y_1^{n_1}y_2^{n_2}\cdots y_m^{n_m}.$$
 \(\square\) </p>
<p>Combining everything together,</p>
<p>$$\begin{aligned}
&amp;\quad\, F_G(y_1,y_2,\ldots,y_m)\\
&amp;=\sum_{\mathbf{v}=(n_1,\ldots,n_m)\atop n_1+\cdots+n_m=n}a_{\mathbf{v}}y_1^{n_1}y_2^{n_2}\cdots y_m^{n_m}\\
&amp;=\sum_{\mathbf{v}=(n_1,\ldots,n_m)\atop n_1+\cdots+n_m=n}\left(\frac{1}{|G|}\sum_{\pi\in G}|X_\pi^{\mathbf{v}}|\right)y_1^{n_1}y_2^{n_2}\cdots y_m^{n_m}
&amp;\quad\text{(due to Claim 1)}\\
&amp;=\frac{1}{|G|}\sum_{\pi\in G}\sum_{\mathbf{v}=(n_1,\ldots,n_m)\atop n_1+\cdots+n_m=n} |X_\pi^{\mathbf{v}}|y_1^{n_1}y_2^{n_2}\cdots y_m^{n_m}\\
&amp;=\frac{1}{|G|}\sum_{\pi\in G}M_\pi\left(\sum_{i=1}^m y_i, \sum_{i=1}^my_i^2,\ldots,\sum_{i=1}^my_i^n\right)
&amp;\quad\text{(due to Claim 2)}\\
&amp;=P_G\left(\sum_{i=1}^m y_i, \sum_{i=1}^m y_i^2,\ldots, \sum_{i=1}^m y_i^n\right).
\end{aligned}$$</p>
</blockquote>
<div style="text-align: right"> Re-typesetted by  </div>
<div style="text-align: right"> [$\texttt{AUGPath}$](https://space.bilibili.com/13246364)  </div>
<div style="text-align: right"> with sincere gratitude.  </div>


    <hr>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/gangdong/gangdong.github.io@dev/assets/js/md5.min.js"></script>
    <div id="gitalk-container" class="hidden"></div>

    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
    </script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
    <script>
      var MD5 = function(d){var r = M(V(Y(X(d),8*d.length)));return r.toLowerCase()};function M(d){for(var _,m="0123456789ABCDEF",f="",r=0;r<d.length;r++)_=d.charCodeAt(r),f+=m.charAt(_>>>4&15)+m.charAt(15&_);return f}function X(d){for(var _=Array(d.length>>2),m=0;m<_.length;m++)_[m]=0;for(m=0;m<8*d.length;m+=8)_[m>>5]|=(255&d.charCodeAt(m/8))<<m%32;return _}function V(d){for(var _="",m=0;m<32*d.length;m+=8)_+=String.fromCharCode(d[m>>5]>>>m%32&255);return _}function Y(d,_){d[_>>5]|=128<<_%32,d[14+(_+64>>>9<<4)]=_;for(var m=1732584193,f=-271733879,r=-1732584194,i=271733878,n=0;n<d.length;n+=16){var h=m,t=f,g=r,e=i;f=md5_ii(f=md5_ii(f=md5_ii(f=md5_ii(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_hh(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_gg(f=md5_ff(f=md5_ff(f=md5_ff(f=md5_ff(f,r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+0],7,-680876936),f,r,d[n+1],12,-389564586),m,f,d[n+2],17,606105819),i,m,d[n+3],22,-1044525330),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+4],7,-176418897),f,r,d[n+5],12,1200080426),m,f,d[n+6],17,-1473231341),i,m,d[n+7],22,-45705983),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+8],7,1770035416),f,r,d[n+9],12,-1958414417),m,f,d[n+10],17,-42063),i,m,d[n+11],22,-1990404162),r=md5_ff(r,i=md5_ff(i,m=md5_ff(m,f,r,i,d[n+12],7,1804603682),f,r,d[n+13],12,-40341101),m,f,d[n+14],17,-1502002290),i,m,d[n+15],22,1236535329),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+1],5,-165796510),f,r,d[n+6],9,-1069501632),m,f,d[n+11],14,643717713),i,m,d[n+0],20,-373897302),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+5],5,-701558691),f,r,d[n+10],9,38016083),m,f,d[n+15],14,-660478335),i,m,d[n+4],20,-405537848),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+9],5,568446438),f,r,d[n+14],9,-1019803690),m,f,d[n+3],14,-187363961),i,m,d[n+8],20,1163531501),r=md5_gg(r,i=md5_gg(i,m=md5_gg(m,f,r,i,d[n+13],5,-1444681467),f,r,d[n+2],9,-51403784),m,f,d[n+7],14,1735328473),i,m,d[n+12],20,-1926607734),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+5],4,-378558),f,r,d[n+8],11,-2022574463),m,f,d[n+11],16,1839030562),i,m,d[n+14],23,-35309556),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+1],4,-1530992060),f,r,d[n+4],11,1272893353),m,f,d[n+7],16,-155497632),i,m,d[n+10],23,-1094730640),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+13],4,681279174),f,r,d[n+0],11,-358537222),m,f,d[n+3],16,-722521979),i,m,d[n+6],23,76029189),r=md5_hh(r,i=md5_hh(i,m=md5_hh(m,f,r,i,d[n+9],4,-640364487),f,r,d[n+12],11,-421815835),m,f,d[n+15],16,530742520),i,m,d[n+2],23,-995338651),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+0],6,-198630844),f,r,d[n+7],10,1126891415),m,f,d[n+14],15,-1416354905),i,m,d[n+5],21,-57434055),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+12],6,1700485571),f,r,d[n+3],10,-1894986606),m,f,d[n+10],15,-1051523),i,m,d[n+1],21,-2054922799),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+8],6,1873313359),f,r,d[n+15],10,-30611744),m,f,d[n+6],15,-1560198380),i,m,d[n+13],21,1309151649),r=md5_ii(r,i=md5_ii(i,m=md5_ii(m,f,r,i,d[n+4],6,-145523070),f,r,d[n+11],10,-1120210379),m,f,d[n+2],15,718787259),i,m,d[n+9],21,-343485551),m=safe_add(m,h),f=safe_add(f,t),r=safe_add(r,g),i=safe_add(i,e)}return Array(m,f,r,i)}function md5_cmn(d,_,m,f,r,i){return safe_add(bit_rol(safe_add(safe_add(_,d),safe_add(f,i)),r),m)}function md5_ff(d,_,m,f,r,i,n){return md5_cmn(_&m|~_&f,d,_,r,i,n)}function md5_gg(d,_,m,f,r,i,n){return md5_cmn(_&f|m&~f,d,_,r,i,n)}function md5_hh(d,_,m,f,r,i,n){return md5_cmn(_^m^f,d,_,r,i,n)}function md5_ii(d,_,m,f,r,i,n){return md5_cmn(m^(_|~f),d,_,r,i,n)}function safe_add(d,_){var m=(65535&d)+(65535&_);return(d>>16)+(_>>16)+(m>>16)<<16|65535&m}function bit_rol(d,_){return d<<_|d>>>32-_}

      var gitalk = new Gitalk({
        clientID: '29ea7d42268db12c5dcb',
        clientSecret: 'c0eb4f0b456aef833271ee26e9a73297e93724ed',
        repo: 'wiki-comments',
        owner: 'shzaiz',
        admin: ['shzaiz'],
        id: MD5(location.pathname),
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')
    </script>
   
  </body>
</html>