<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <link rel="stylesheet" href="https://courses-at-nju-by-hfwei.github.io/cpl-lectures/node_modules/reveal.js-plugins/chalkboard/style.css">
    <script src="https://courses-at-nju-by-hfwei.github.io/cpl-lectures/node_modules/reveal.js-plugins/chalkboard/plugin.js"></script> 
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
 
    <script>
const copyButtonLabel = "Copy Code";

// use a class selector if available
let blocks = document.querySelectorAll("pre");

blocks.forEach((block) => {
  // only add button if browser supports Clipboard API
  if (navigator.clipboard) {
    let button = document.createElement("button");

    button.innerText = copyButtonLabel;
    block.appendChild(button);

    button.addEventListener("click", async () => {
      await copyCode(block);
    });
  }
});

async function copyCode(block) {
  let code = block.querySelector("code");
  let text = code.innerText;

  await navigator.clipboard.writeText(text);
}
    </script>
      <style>
        body {counter-reset:section;}
        h1 {counter-reset:subsection;font-size:x-large;}
        h2 {font-size: large;}
        
        h1:before {
        counter-increment:section;
        content:counter(section) ". ";
            font-weight:bold;
            font-size: x-large;
        }
        h2:before {
        counter-increment:subsection;
        content:counter(section) "." counter(subsection) " ";
        font-size: large;
        }
        html, body {
            margin: 5%;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-weight: 500;
        }
        code {
            font-family: 'Courier New', Courier, monospace;
        } 

        pre {
            font-family: 'Courier New', Courier, monospace;
        } 
        div{
            max-width: 100%;
            overflow: auto;
            
        }
        .navbar {
            overflow: hidden;
            background-color: #333;
            position: fixed; /* Set the navbar to fixed position */
            top: 0; /* Position the navbar at the top of the page */
            width: 100%; /* Full width */
        }

        img {
        max-width: 80%;
        height: auto;
        }
        .navbar a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
        }

        a {
            color: #148bca;
            text-align: center;
            padding-left: 2px;
            padding-right: 2px;
            text-decoration: none;
        }

        p.hidden {
          overflow: hidden;
        }

    </style>
  </head>
  <body>
    
    <div class="navbar">
        <a href="https://shzaiz.github.io">AUG's Wiki</a>
        <a href="index.html"> ↑ Back to contents</a>
        Last updated at 2023-05-12 22:34:51.757042
    </div>

    <div class="toc"></div>
    <a id="toc-button"><i class="far fa-bookmark"></i></a>
    
    <div>
      <p>$$
\Huge \left[\left[\sum\right]_{}\right]\\
\small\textbf{etoneWiki}
$$</p>
<p>$$
\Huge \textbf{Basic enumeration}\\
\small \texttt{by etone on Combinatorial Mathematics}\\
\texttt{Spring, 2015 at Nanjing University}
$$</p>
<blockquote>
<p>Contents
[toc]{level: [1,2,3,4,5]}</p>
</blockquote>
<h1>Basic Enumeration</h1>
<p>The <em>three</em> basic rules for enumeration are:</p>
<ul>
<li><strong>The sum rule</strong>: for any disjoint finite sets S and T, the cardinality of the union  \(|S\cup T|=|S|+|T|\) .</li>
<li><strong>The product rule</strong>: for any finite sets S and T, the cardinality of the Cartesian product  \(|S\times T|=|S|\cdot|T|\) .</li>
<li><strong>The bijection rule</strong>: if there exists a bijection between finite sets S and T, then  \(| S | = | T |\)  .</li>
</ul>
<h3>Tuples</h3>
<p>We count the number of  \(n-\) tuples of  \([m]\) . Formally, we count the number of elements of  \([m]^n\) . (Remember that  \([m]=\{0,1,2,\ldots,m-1\}\) .)</p>
<p>It is not very hard to see that this number is  \(m^n\) . That is,  \(| [m]^n | = m^n\) .</p>
<p>To prove this rigorously, we use &quot;the product rule&quot;.</p>
<ul>
<li>The product rule: for any finite sets  \(S\)  and  \(T\) , the cardinality of the Cartesian product  \(|S\times T|=|S|\cdot|T|\) .</li>
</ul>
<p>To count the size of  \([m]^n\) , we write  \([m]^n=[m]\times[m]^{n-1}\) , thus \(|[m]^n|=m\cdot|[m]^{n-1}|\) . Solving the recursion, we have that  \(|[m]^n|=m^n\) .</p>
<h3>Functions</h3>
<p>Consider the problem of counting the number of functions mapping from  \([n]\)  to  \([m]\) , i.e. we count the number of functions in the form  \(f:[n]\rightarrow [m]\) .</p>
<p>We claim that this is the same as counting the number of  \(n-\) tuples of  \([m]\) . To see this, for any  \(f:[n]\rightarrow [m]\) , we define a tuple  \(v_f\in[m]^n\)  by letting  \(v_f(i) = f(i − 1)\)  for every  \(i=1,2,\ldots,n\) . It is easy to verify that  \(v\)  defines a <strong>bijection</strong> (a 1-1 correspondence) between  \(\{f:[n]\rightarrow [m]\}\)  and  \([m]^n\) . (Consider this as an exercise.)</p>
<p>Now we summon the &quot;the bijection rule&quot;.</p>
<ul>
<li>The bijection rule: if there exists a bijection between finite sets  \(S\)  and  \(T\) , then  \(| S | = | T |\)  .
Applying this rule, we have that the number of functions from  \([n]\)  to  \([m]\)  equals the number of tuples in  \([m]^n\) , which is  \(m^n\)  as we proved previously.</li>
</ul>
<h3>Subsets</h3>
<p>We count the number of subsets of a set.</p>
<p>Let  \(S=\{x_1,x_2,\ldots,x_n\}\)  be an  \(n-\) element set, or <strong>n-set</strong> for short. Let  \(2^S=\{T\mid T\subset S\}\)  denote the set of all subset of  \(S\) .  \(2^S\)  is called the <strong>power set</strong> of  \(S\) .</p>
<p>We give a combinatorial proof that  \(| 2^S | = 2^n\) . We observe that every subset  \(T\in 2^S\)  corresponds to a unique bit-vector  \(v\in\{0,1\}^S\) , such that each bit  \(v_i\)  indicates whether  \(x_i\in S\) . Formally, define a map  \(\phi:2^S\rightarrow\{0,1\}^n\)  by  \(\phi(T)=(v_1,v_2,\ldots,v_n)\) , where
$$
v_i=\begin{cases}
1 &amp; \text{if }x_i\in T\\
0 &amp; \text{if }x_i\not\in T.
\end{cases}
$$
The map  \(\varphi\)  is a bijection. The proof that  \(\varphi\)  is a bijection is left as an exercise.</p>
<p>Since there is a bijection between  \(2^S\)  and  \(\{0,1\}^n\) , it holds that  \(|2^S|=|\{0,1\}^n|=2^n\) .</p>
<p>There are two elements of the proof:</p>
<ul>
<li>Find a 1-1 correspondence between subsets of an  \(n\) -set and  \(n\) -bit vectors.
An application of this in Computer Science is that we can use bit-array as a data structure for sets: any set defined over a universe  \(U\)  can be represented by an array of  \(| U |\)  bits.</li>
<li>The bijection rule: if there is a 1-1 correspondence between two sets, then their cardinalities are the same.
Many counting problems are solved by establishing a bijection between the set to be counted and some easy-to-count set. This kind of proofs are usually called (non-rigorously) <strong>combinatorial proofs</strong>.</li>
</ul>
<hr />
<p>We give an alternative proof that  \(| 2^S | = 2^n\) . The proof needs another basic counting rule: &quot;<em>the sum rule</em>&quot;.</p>
<ul>
<li><strong>The sum rule</strong>: for any disjoint finite sets S and T, the cardinality of the union  \(|S\cup T|=|S|+|T|\) .</li>
</ul>
<p>Define the function  \(f(n)=|2^{S_n}|\) , where  \(S_n=\{x_1,x_2,\ldots,x_n\}\)  is an  \(n\) -set. Our goal is to compute  \(f(n)\) . We prove the following recursion for  \(f(n)\) .</p>
<blockquote>
<p>Lemma
$$f(n)=2f(n-1).$$</p>
</blockquote>
<blockquote>
<p>Proof
Fix an element  \(x_n\) , let  \(U\)  be the set of subsets of  \(S_n\)  that contain  \(x_n\)  and let  \(V\)  be the set of subsets of  \(S_n\)  that do not contain  \(x_n\) . It is obvious that  \(U\)  and  \(V\)  are disjoint (i.e.  \(U\cap V=\emptyset\) ) and  \(2^{S_n}=U\cup V\) , because any subset of Sn either contains  \(x_n\)  or does not contain  \(x_n\)  but not both.</p>
<p>Applying the sum rule,</p>
<p>$$f(n)=|U\cup V|=|U|+|V|.$$</p>
<p>The next observation is that  \(| U | = | V | = f(n − 1)\) , because V is exactly the  \(2^{S_{n-1}}\) , and  \(U\)  is the set resulting from adding  \(x_n\)  to every member of  \(2^{S_{n-1}}\) . Therefore,</p>
<p> \(f(n)=|U|+|V|=f(n-1)+f(n-1)=2f(n-1)\,\) . \(\square\) </p>
</blockquote>
<p>The elementary case  \(f(0) = 1\) , because  \(\emptyset\)  has only one subset  \(\emptyset\) . Solving the recursion, we have that  \(| 2^S | = f(n) = 2^n\) .</p>
<h3>Subsets of fixed size</h3>
<p>We then count the number of subsets of fixed size of a set. Again, let  \(S=\{x_1,x_2,\ldots,x_n\}\)  be an  \(n-\) set. We define  \({S\choose k}\)  to be the set of all k-elements subsets (or k-subsets) of S. Formally,  \({S\choose k}=\{T\subseteq S\mid |T|=k\}\) . The set  \({S\choose k}\)  is sometimes called the k-uniform of  \(S\) .</p>
<p>We denote that  \({n\choose k}=\left|{S\choose k}\right|\) . The notation  \({n\choose k}\)  is read &quot;n choose k&quot;.</p>
<blockquote>
<p>Theorem
$${n\choose k}=\frac{n(n-1)\cdots(n-k+1)}{k(k-1)\cdots 1}=\frac{n!}{k!(n-k)!}.$$</p>
</blockquote>
<blockquote>
<p>Proof:
The number of ordered k-subsets of an  \(n-\) set is n \((n-1)\cdots(n-k+1)\) . Every k-subset has  \(k!=k(k-1)\cdots1\)  ways to order it. \(\square\) </p>
</blockquote>
<p>Some notations</p>
<ul>
<li> \(n!\) , read &quot;n factorial&quot;, is defined as that  \(n!=n(n-1)(n-2)\cdots 1\) , with the convention that  \(0! = 1\) .</li>
<li> \(n(n-1)\cdots(n-k+1)=\frac{n!}{(n-k)!}\)  is usually denoted as  \((n)_k\,\) , read &quot;n lower factorial k&quot;.</li>
</ul>
<h3>Binomial coefficient</h3>
<p>The quantity  \({n\choose k}\)  is called a binomial coefficient.</p>
<blockquote>
<p>Proposition
$${n\choose k}={n\choose n-k};$$
$$\sum_{k=0}^n {n\choose k}=2^n.$$</p>
</blockquote>
<blockquote>
<p>Proof</p>
<ul>
<li>We give two proofs for the first equation:
<ul>
<li>
<p>(numerical proof)
 \({n\choose k}=\frac{n!}{k!(n-k)!}={n\choose n-k}\) </p>
</li>
<li>
<p>(combinatorial proof)
Choosing  \(k\)  elements from an  \(n\) -set is equivalent to choosing the  \(n − k\)  elements to leave out. Formally, every k-subset  \(T\in{S\choose k}\)  is uniquely specified by its complement  \(S\setminus T\in {S\choose n-k}\) , and the same holds for  \((n − k)\) -subsets, thus we have a bijection between  \({S\choose k}\)  and  \({S\choose n-k}\) .</p>
</li>
</ul>
</li>
<li>The second equation can also be proved in different ways, but the combinatorial proof is much easier. For an  \(n\) -element set  \(S\) , it is obvious that we can enumerate all subsets of \(S\)  by enumerating  \(k\) -subsets for every possible size  \(k\) , i.e. it holds that \(2^S=\bigcup_{k=0}^n{S\choose k}\) 
For different k, {S\choose k} are obviously disjoint. By the sum rule,
$$2^n=|2^S|=\left|\bigcup_{k=0}^n{S\choose k}\right|=\sum_{k=0}^n\left|{S\choose k}\right|=\sum_{k=0}^n {n\choose k}.$$
 \(\square\) </li>
</ul>
</blockquote>
<p> \({n\choose k}\)  is called binomial coefficient for a reason. The following celebrated Binomial Theorem states that if a power of a binomial is expanded, the coefficients in the resulting polynomial are the binomial coefficients.</p>
<p>Theorem (Binomial theorem)
$$(1+x)^n=\sum_{k=0}^n{n\choose k}x^k.$$</p>
<blockquote>
<p>Proof
Write  \((1 + x)^n\)  as the product of  \(n\)  factors</p>
<p>$$(1+x)(1+x)\cdots (1+x).$$
The term  \(x^k\)  is obtained by choosing  \(x\)  from  \(k\)  factors and  \(1\)  from the rest  \((n − k)\)  factors. There are  \({n\choose k}\)  ways of choosing these k factors, so the coefficient of  \(x^k\)  is  \({n\choose k}\) .</p>
<p> \(\square\) </p>
</blockquote>
<p>The following proposition has an easy proof due to the binomial theorem.</p>
<blockquote>
<p>Proposition
For  \(n &gt; 0\) , the numbers of subsets of an  \(n-\) set of even and of odd cardinality are equal.</p>
</blockquote>
<blockquote>
<p>Proof.
Set  \(x = − 1\)  in the binomial theorem.</p>
<p>$$0=(1-1)^n=\sum_{k=0}^n{n\choose k}(-1)^k=\sum_{\overset{0\le k\le n}{k \text{ even}}}{n\choose k}-\sum_{\overset{0\le k\le n}{k \text{ odd}}}{n\choose k},$$
therefore,</p>
<p>$$\sum_{\overset{0\le k\le n}{k \text{ even}}}{n\choose k}=\sum_{\overset{0\le k\le n}{k \text{ odd}}}{n\choose k}.$$
 \(\square\) </p>
</blockquote>
<p>For counting problems, what we care about are numbers. In the binomial theorem, a formal variable  \(x\)  is introduced. It looks having nothing to do with our problem, but turns out to be very useful. This idea of introducing a formal variable is the basic idea of some advanced counting techniques, which will be discussed in future classes.</p>
<h3>Compositions of an integer</h3>
<p>A composition of n is an expression of n as an ordered sum of positive integers. A  \(k\) -composition of  \(n\)  is a composition of  \(n\)  with exactly  \(k\)  positive summands.</p>
<p>Formally, a  \(k-\) composition of n is a  \(k-\) tuple  \((a_1,a_2,\ldots,a_k)\in\{1,2,\ldots,n\}^k\)  such that  \(a_1+a_2+\cdots+a_k=n\) .</p>
<p>Suppose we have n identical balls in a line. A  \(k-\) composition partitions these n balls into  \(k\)  nonempty sets, illustrated as follows.</p>
<p>$$\begin{array}{c|cc|c|c|ccc|cc}
\bigcirc \,&amp;\, \bigcirc \,&amp; \bigcirc \,&amp;\, \bigcirc \,&amp;\, \bigcirc \,&amp;\, \bigcirc &amp;\, \bigcirc &amp;\, \bigcirc \,&amp;\, \bigcirc \,&amp; \bigcirc
\end{array}$$
So the number of  \(k-\) compositions of n equals the number of ways we put  \(k − 1\)  bars &quot; | &quot; into  \(n − 1\)  slots &quot; \(\sqcup\) &quot;, where each slot has at most one bar (because all the summands  \(a_i &gt; 0\) ):</p>
<p>$$\bigcirc \sqcup \bigcirc \sqcup \bigcirc \sqcup \bigcirc \sqcup \bigcirc \sqcup \bigcirc \sqcup \bigcirc \sqcup \bigcirc \sqcup \bigcirc \sqcup \bigcirc$$
which is equal to the number of ways of choosing  \(k − 1\)  slots out of  \(n − 1\)  slots, which is  \({n-1\choose k-1}\) .</p>
<p>This graphic argument can be expressed as a formal proof. We construct a bijection between the set of  \(k\) -compositions of  \(n\)  and  \({\{1,2,\ldots,n-1\}\choose k-1}\)  as follows.</p>
<p>Let  \(\phi\)  be a mapping that given a  \(k\) -composition  \((a_1,a_2,\ldots,a_k)\)  of  \(n\) ,</p>
<p>$$\begin{aligned}
\phi((a_1,a_2,\ldots,a_k))
&amp;=\{a_1,\,\,a_1+a_2,\,\,a_1+a_2+a_3,\,\,\ldots,\,\,a_1+a_2+\cdots+a_{k-1}\}\\
&amp;=\left\{\sum_{i=1}^ja_i\,\,\bigg|\,\, 1\le j&lt;k\right\}.
\end{aligned}
$$
 \(\phi\)  maps every  \(k\) -composition to a  \((k − 1)\) -subset of  \(\{1,2,\ldots,n-1\}\) . It is easy to verify that  \(φ\)  is a bijection, thus the number of  \(k\) -compositions of  \(n\)  is \({n-1\choose k-1}\) .</p>
<hr />
<p>The number of  \(k\) -compositions of  \(n\)  is equal to the number of solutions to  \(x_1+x_2+\cdots+x_k=n\)  in positive integers. This suggests us to relax the constraint and count the number of solutions to  \(x_1+x_2+\cdots+x_k=n\)  in nonnegative integers. We call such a solution a weak  \(k\) -composition of  \(n\) .</p>
<p>Formally, a weak  \(k\) -composition of n is a tuple  \((x_1,x_2,\ldots,x_k)\in[n+1]^k\)  such that  \(x_1+x_2+\cdots+x_k=n\) .</p>
<p>Given a weak  \(k\) -composition  \((x_1,x_2,\ldots,x_k)\)  of  \(n\) , if we set  \(y_i = x_i + 1\)  for every  \(1\le i\le k\) , then  \(y_i &gt; 0\)  and</p>
<p>$$
\begin{aligned}
y_1+y_2+\cdots +y_k 
&amp;=(x_1+1)+(x_2+1)+\cdots+(x_k+1)\\&amp;=n+k,
\end{aligned}
$$</p>
<p>i.e.,  \((y_1,y_2,\ldots,y_k)\)  is a  \(k-\) composition of  \(n + k\) . It is easy to see that it defines a bijection between weak  \(k-\) compositions of  \(n\)  and  \(k\) -compositions of  \(n + k\) . Therefore, the number of weak  \(k\) -compositions of  \(n\)  is  \({n+k-1\choose k-1}\) .</p>
<hr />
<p>We now count the number of solutions to  \(x_1+x_2+\cdots+x_k\le n\)  in nonnegative integers.</p>
<p>Let  \(x_{k+1}=n-(x_1+x_2+\cdots+x_k)\) . Then  \(x_{k+1}\ge 0\)  and  \(x_1+x_2+\ldots+x_k+x_{k+1}=n\) . The problem is transformed to that counting the number of solutions to the above equation in nonnegative integers. The answer is \({n+k\choose k}\) .</p>
<h3>Multisets</h3>
<p>A  \(k\) -subset of an  \(n\) -set  \(S\)  is sometimes called a  \(k-\) combination of  \(S\)  without repetitions. This suggests the problem of counting the number of  \(k\) -combinations of  \(S\)  with repetitions; that is, we choose  \(k\)  elements of  \(S\) , disregarding order and allowing repeated elements.</p>
<blockquote>
<p>Example
 \(S = {1,2,3,4}\) .
All 3-combination without repetitions are
$$\{1,2,3\},\{1,2,4\},\{1,3,4\},\{2,3,4\}\,.$$
Allowing repetitions, we also include the following 3-combinations:</p>
<p>$$\begin{aligned}
&amp;\{1,1,1\},\{1,1,2\},\{1,1,3\},\{1,1,4\},\{1,2,2\},\{1,3,3\},\{1,4,4\},\\
&amp;\{2,2,2\},\{2,2,3\},\{2,2,4\},\{2,3,3\},\{2,4,4\},\\
&amp;\{3,3,3\},\{3,3,4\},\{3,4,4\}\\
&amp;\{4,4,4\}
\end{aligned}$$</p>
</blockquote>
<p>Combinations with repetitions can be formally defined as multisets. A multiset is a set with repeated elements. Formally, a multiset  \(M\)  on a set  \(S\)  is a function  \(m:S\rightarrow \mathbb{N}.\)  For any element  \(x\in S\) , the integer  \(m(x)\ge 0\)  is the number of repetitions of  \(x\)  in M, called the <strong>multiplicity</strong> of  \(x\) . The sum of multiplicities  \(\sum_{x\in S}m(x)\)  is called the cardinality of  \(M\)  and is denoted as  \(| M |\)  .</p>
<p>A  \(k\) -multiset on a set  \(S\)  is a multiset  \(M\)  on  \(S\)  with  \(| M | = k\) . It is obvious that a  \(k\) -combination of S with repetition is simply a  \(k\) -multiset on S.</p>
<p>The set of all  \(k\) -multisets on S is denoted  \(\left({S\choose k}\right)\) . Assuming that  \(n = | S |\)  , denote  \(\left({n\choose k}\right)=\left|\left({S\choose k}\right)\right|\) , which is the number of  \(k-\) combinations of an  \(n-\) set with repetitions.</p>
<p>Believe it or not: we have already evaluated the number  \(\left({n\choose k}\right)\) . If  \(S=\{x_1,x_2,\ldots,x_n\}\) , let  \(z_i = m(x_i)\) , then  \(\left({n\choose k}\right)\)  is the number of solutions to  \(z_1+z_2+\cdots+z_n=k\)  in nonnegative integers, which is the number of weak  \(n-\) compositions of  \(k\) , which we have seen is  \({n+k-1\choose n-1}={n+k-1\choose k}\) .</p>
<hr />
<p>There is a direct combinatorial proof that  \(\left({n\choose k}\right)={n+k-1\choose k}\) .</p>
<p>Given a  \(k-\) multiset  \(0\le a_0\le a_1\le\cdots\le a_{k-1}\le n-1\)  on  \([n]\) , then defining  \(b_i = a_i + i\) , we see that  \(\{b_0,b_1,\ldots,b_{k-1}\}\)  is a  \(k\) -subset of  \([n + k − 1]\) . Conversely, given a  \(k\) -subset  \(0\le b_0\le b_1\le\cdots\le b_{k-1}\le n+k-2\)  of  \([n + k − 1]\) , then defining  \(a_i = b_i − i\) , we have that  \(\{a_0,a_1,\ldots,a_{k-1}\}\)  is a  \(k\) -multiset on  \([n]\) . Therefore, we have a bijection between  \(\left({[n]\choose k}\right) and {[n+k-1]\choose k}\) .</p>
<h3>Multinomial coefficients</h3>
<p>The binomial coefficient  \({n\choose k}\)  may be interpreted as follows. Each element of an  \(n-\) set is placed into two groups, with k elements in Group 1 and  \(n − k\)  elements in Group 2. The binomial coefficient  \({n\choose k}\)  counts the number of such placements.</p>
<p>This suggests a generalization allowing more than two groups. Let  \((a_1,a_2,\ldots,a_m)\)  be a tuple of nonnegative integers summing to n. Let  \({n\choose a_1,a_2,\ldots,a_m}\)  denote the number of ways of assigning each element of an  \(n-\) set to one of  \(m\)  groups  \(G_1,G_2,\ldots,G_m\)  so that exactly  \(a_i\)  elements are assigned to  \(G_i\) .</p>
<p>The binomial coefficient is just the case when there are two groups, and  \({n\choose k}={n\choose k,n-k}\) . The number  \({n\choose a_1,a_2,\ldots,a_m}\)  is called a multinomial coefficient. We can think of it as that  \(n\)  labeled balls are assigned to  \(m\)  labeled bins, and  \({n\choose a_1,a_2,\ldots,a_m}\)  is the number of assignments such that the i-th bin has  \(a_i\)  balls in it.</p>
<p>The multinomial coefficient can also be interpreted as the number of permutations of multisets. A permutation  \(π\)  of an  \(n\) -set  \(S\)  can be defined in two equivalent ways:</p>
<ul>
<li>a bijection  \(\pi:S\rightarrow S\) ;</li>
<li>a tuple  \(\pi=(x_1,x_2,\ldots,x_n)\in S^n\)  such that all  \(x_i\)  are distinct.</li>
</ul>
<p>There are  \(n!\)  permutations of an  \(n-\) set S.</p>
<p>A permutation of a multiset  \(M\)  is a tuple  \(\pi=(x_1,x_2,\ldots,x_n)\)  such that every  \(x_i\in M\) appears in  \(π\)  for exactly  \(m(x_i)\)  times, where  \(m(x_i)\)  is the multiplicity of  \(x_i\)  in  \(M\) .</p>
<blockquote>
<p>Example
We want to enumerate all the ways of reordering the word &quot;multinomial&quot;. Note that in this word, the letter &quot;m&quot;, &quot;l&quot; and &quot;i&quot; each appears twice. So the problem is to enumerate the permutations of the multiset {a, i, i, l, l, m, m, n, o, t, u}.</p>
</blockquote>
<p>Let  \(M\)  be a multiset of m distinct elements  \(x_1,x_2,\ldots,x_m\)  such that  \(x_i\)  has multiplicity  \(a_i\)  in  \(M\) . A permutation  \(π\)  of multiset  \(M\)  assigns  \(n\)  indices  \(1,2,\ldots,n\)  to  \(m\)  groups, where each group corresponds to a distinct element  \(x_i\) , such that  \(i\)  is assigned to group  \(j\)  if  \(π_i = x_j\) .</p>
<p>Therefore, \({n\choose a_1,a_2,\ldots,a_m}\)  is also the number of permutations of a multiset  \(M\)  with  \(| M | = n\)  such that  \(M\)  has m distinct elements whose multiplicities are given by  \(a_1,a_2,\ldots,a_m\) .</p>
<blockquote>
<p>Theorem
$${n\choose a_1,a_2,\ldots,a_m}=\frac{n!}{a_1!a_2!\cdots a_m!}.$$</p>
</blockquote>
<blockquote>
<p>Proof.
There are  \(n!\)  permutations of  \(n\)  objects. Assume that these  \(n\)  objects are the elements of an multiset  \(M\)  of  \(m\)  distinct elements with  \(| M | = n\)  and multiplicities  \(a_1,a_2,\ldots,a_m\) . Since  \(a_i!\)  permutations of object  \(i\)  do not change the permutation of the multiset  \(M\) , every  \(a_1!a_2!\cdots a_m!\)  permutations of these  \(n\)  objects correspond to the same permutation of the multiset  \(M\) . Thus, the number of permutations of  \(M\)  is  \(\frac{n!}{a_1!a_2!\cdots a_m!}\) .</p>
<p> \(\square\) </p>
</blockquote>
<p>We also have the Multinomial Theorem.</p>
<blockquote>
<p>Theorem
 \({n\choose a_1,a_2,\ldots,a_m}\)  is the coefficient of  \(x_1^{a_1}x_2^{a_2}\cdots x_m^{a_m}\)  in  \((x_1+x_2+\cdots +x_m)^n.\) </p>
</blockquote>
<blockquote>
<p>Proof.
Write</p>
<p>$$(x_1+x_2+\cdots +x_m)^n=(x_1+x_2+\cdots +x_m)\cdots (x_1+x_2+\cdots +x_m).$$
Each of the n factors corresponds to a distinct ball, and  \(x_1,x_2,\ldots,x_m\)  correspond to  \(m\)  groups. The coefficient of  \(x_1^{a_1}x_2^{a_2}\cdots x_m^{a_m}\)  equals the number of ways to put ndistinct balls to m distinct groups so that group i receives ai balls, which is exactly our first definition of  \({n\choose a_1,a_2,\ldots,a_m}\) .</p>
<p> \(\square\) </p>
</blockquote>
<h3>Partitions of a set</h3>
<p>A partition of finite set S is a collection  \(P=\{S_1,S_2,\ldots,S_k\}\)  of subsets of S such that:</p>
<ul>
<li> \(S_i\neq\emptyset\)  for every  \(i\) ;</li>
<li> \(S_i\cap S_j=\emptyset\)  if  \(i\neq j\)  (also called that blocks are pairwise <strong>disjoint</strong>);</li>
<li> \(S_1\cup S_2\cup\cdots\cup S_k=S.\) </li>
</ul>
<p>Each  \(S_i\)  is called a <strong>block</strong> of partition  \(P\) . We call  \(P\)  a <strong> \(k\) -partition</strong> of  \(S\)  if  \(| P | = k\) .</p>
<p>Define  \(\left\{{n \atop k}\right\}\)  to be the number of  \(k\) -partitions of an  \(n\) -set. Note that since a partition  \(P\)  is a set, the order of blocks  \(S_1,S_2,\ldots,S_k\)  is disregarded when counting  \(k\) -partitions.</p>
<p>The number  \(\left\{{n \atop k}\right\}\)  is called a <strong>Stirling number of the second kind</strong>.</p>
<h3>Stirling number</h3>
<blockquote>
<p><a href="https://en.wikipedia.org/wiki/Stirling_numbers">Stirling numbers</a> are named after James Stirling.There are two kinds of Stirling numbers. <a href="https://en.wikipedia.org/wiki/Stirling_numbers_of_the_first_kind">Stirling number of the first kind</a> is related to the number of permutations with fixed number of disjoint cycles. And <a href="https://en.wikipedia.org/wiki/Stirling_numbers_of_the_second_kind">Stirling number of the second kind</a> counts the number of ways of partitioning a set into fixed number of disjoint blocks. Both numbers arise from important combinatorial problems and have various applications in combinatorics and other branches of Mathematics.</p>
</blockquote>
<p>Unlike previous identities, it is very difficult to give a determinant for \(\left\{{n \atop k}\right\}\) . But we have the following recurrence:</p>
<blockquote>
<p>Theorem
$$\left\{{n \atop k}\right\}=k\left\{{n-1 \atop k}\right\}+\left\{{n-1 \atop k-1}\right\}.$$</p>
</blockquote>
<blockquote>
<p>Proof.
To partition  \(\{1,2,\ldots,n\}\)  into  \(k\)  blocks,</p>
<p>we can partition  \(\{1,2,\ldots,{n-1}\}\)  into  \(k\)  blocks and place  \(n\)  into one of the  \(k\)  blocks, which gives us  \(k\left\{{n-1 \atop k}\right\}\)  ways to do so;
or we can partition  \(\{1,2,\ldots,{n-1}\}\)  into k − 1 blocks and let  \(\{n\}\)  be a block by itself, which gives us  \(\left\{{n-1 \atop k-1}\right\}\)  ways to do so.
The partitions constructed by these two methods are different, since by the first method,  \(n\)  is always in a block of cardinality  \(&gt; 1\) , and by the second method,  \(\{n\}\)  is always a block. So the cases are disjoint. And any  \(k-\) partition of an  \(n\) -set must be constructible by one of the two methods, thus by the sum rule,</p>
<p>$$\,\left\{{n \atop k}\right\}=k\left\{{n-1 \atop k}\right\}+\left\{{n-1 \atop k-1}\right\}.$$
 \(\square\) </p>
</blockquote>
<p>Let  \(B_n=\sum_{k=1}^n \left\{{n \atop k}\right\}\) , which gives the total number of partitions of an  \(n\) -set.  \(B(n)\)  is called the Bell number.</p>
<h3>Partitions of a number</h3>
<p>We count the ways of partitioning n identical objects into k unordered groups. This is equivalent to counting the ways partitioning a number n into k unordered parts.</p>
<p>A  \(k\) -partition of a number  \(n\)  is a multiset  \(\{x_1,x_2,\ldots,x_k\}\)  with  \(x_i\ge 1\)  for every element  \(x_i\)  and  \(x_1+x_2+\cdots+x_k=n\) .</p>
<p>We define  \(p_k(n)\)  as the number of  \(k\) -partitions of  \(n\) .</p>
<p>For example, number  \(7\)  has the following partitions:</p>
<p>$$
\begin{aligned}
&amp;\{7\}
&amp; p_1(7)=1\\
&amp;\{1,6\},\{2,5\},\{3,4\}
&amp; p_2(7)=3\\
&amp;\{1,1,5\}, \{1,2,4\}, \{1,3,3\}, \{2,2,3\} 
&amp; p_3(7)=4\\
&amp;\{1,1,1,4\},\{1,1,2,3\}, \{1,2,2,2\}
&amp; p_4(7)=3\\
&amp;\{1,1,1,1,3\},\{1,1,1,2,2\}
&amp; p_5(7)=2\\
&amp;\{1,1,1,1,1,2\}
&amp; p_6(7)=1\\
&amp;\{1,1,1,1,1,1,1\}
&amp; p_7(7)=1
\end{aligned}
$$</p>
<p>Equivalently, we can also define that A  \(k\) -partition of a number  \(n\)  is a  \(k\) -tuple  \((x_1,x_2,\ldots,x_k)\)  with:</p>
<ul>
<li> \(x_1\ge x_2\ge\cdots\ge x_k\ge 1\) ;</li>
<li> \(x_1+x_2+\cdots+x_k=n\) .</li>
</ul>
<p> \(p_k(n)\)  the number of integral solutions to the above system.</p>
<p>Let  \(p(n)=\sum_{k=1}^n p_k(n)\)  be the total number of partitions of  \(n\) . The function  \(p(n)\)  is called the partition number.</p>
<p>We now try to determine  \(p_k(n)\) . Unfortunately,  \(p_k(n)\)  does not have a nice closed form formula. We now give a recurrence for  \(p_k(n)\) .</p>
<blockquote>
<p>Proposition
$$p_k(n)=p_{k-1}(n-1)+p_k(n-k)\,.$$</p>
</blockquote>
<blockquote>
<p>Proof.
Suppose that  \((x_1,\ldots,x_k)\)  is a  \(k\) -partition of  \(n\) . Note that it must hold that</p>
<ul>
<li> \(x_1\ge x_2\ge \cdots \ge x_k\ge 1.\) </li>
<li>There are two cases:  \(x_k = 1\)  or  \(x_k &gt; 1.\) </li>
</ul>
<p>Case 1.
If  \(x_k = 1\) , then  \((x_1,\cdots,x_{k-1})\)  is a distinct  \((k − 1)\) -partition of  \(n − 1\) . And every  \((k − 1)\) -partition of  \(n − 1\)  can be obtained in this way. Thus the number of  \(k\) -partitions of n in this case is  \(p_{k − 1}(n − 1)\) .
Case 2.
If  \(x_k &gt; 1\) , then  \((x_1-1,\cdots,x_{k}-1)\)  is a distinct  \(k\) -partition of  \(n − k\) . And every  \(k\) -partition of  \(n − k\)  can be obtained in this way. Thus the number of  \(k\) -partitions of  \(n\)  in this case is  \(p_k(n − k)\) .
In conclusion, the number of  \(k-\) partitions of n is  \(p_{k − 1}(n − 1) + p_k(n − k)\) , i.e.</p>
<p>$$p_k(n)=p_{k-1}(n-1)+p_k(n-k)\,.$$
 \(\square\) </p>
</blockquote>
<p>Use the above recurrence, we can compute the  \(p_k(n)\)  for some decent  \(n\)  and  \(k\)  by computer simulation.</p>
<p>If we are not restricted ourselves to the precise estimation of  \(p_k(n)\) , the next theorem gives an asymptotic estimation of  \(p_k(n)\) . Note that it only holds for constant  \(k\) , i.e.  \(k\)  does not depend on  \(n\) .</p>
<blockquote>
<p>Theorem
For any fixed k,</p>
<p>$$p_k(n)\sim\frac{n^{k-1}}{k!(k-1)!},$$
as  \(n\rightarrow \infty\) .</p>
</blockquote>
<blockquote>
<p>Proof.
Suppose that  \((x_1,\ldots,x_k)\)  is a  \(k-\) partition of n. Then  \(x_1+x_2+\cdots+x_k=n\)  and  \(x_1\ge x_2\ge \cdots \ge x_k\ge 1\) .</p>
<p>The  \(k!\)  permutations of  \((x_1,\ldots,x_k)\)  yield at most  \(k!\)  many  \(k\) -compositions (the ordered sum of  \(k\)  positive integers). There are  \({n-1\choose k-1}\)  many  \(k-\) compositions of  \(n\) , every one of which can be yielded in this way by permuting a partition. Thus,</p>
<p>$$k!p_k(n)\ge{n-1\choose k-1}.$$
Let  \(y_i = x_i + k − i\) . That is, \(y_k=x_k, y_{k-1}=x_{k-1}+1, y_{k-2}=x_{k-2}+2,\ldots, y_{1}=x_{1}+k-1.\)  Then, it holds that</p>
<ul>
<li> \(y_1&gt;y_2&gt;\cdots&gt;y_k\ge 1;\)  and</li>
<li> \(y_1+y_2+\cdots+y_k=n+\frac{k(k-1)}{2}\) .
Each permutation of  \((y_1,y_2,\ldots,y_k)\)  yields a distinct  \(k\) -composition of  \(n+\frac{k(k-1)}{2}\) , because all  \(y_i\)  are distinct. Thus,</li>
</ul>
<p>$$k!p_k(n)\le {n+\frac{k(k-1)}{2}-1\choose k-1}.$$
Combining the two inequalities, we have</p>
<p>$$\frac{{n-1\choose k-1}}{k!}\le p_k(n)\le \frac{{n+\frac{k(k-1)}{2}-1\choose k-1}}{k!}.$$
The theorem follows.</p>
<p> \(\square\) </p>
</blockquote>
<h3>Ferrers diagram</h3>
<p>A partition of a number n can be represented as a diagram of dots (or squares), called a Ferrers diagram (the square version of Ferrers diagram is also called a Young diagram, named after a structured called Young tableaux).</p>
<p>Let  \((x_1,x_2,\ldots,x_k)\)  with that  \(x_1\ge x_2\ge \cdots x_k\ge 1\)  be a partition of  \(n\) . Its Ferrers diagram consists of  \(k\)  rows, where the  \(i\) -th row contains  \(x_i\)  dots (or squares).</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>. . . . .
. . . .
. .
.
Ferrers diagram (dot version) of (5,4,2,1)
</pre></div>

<p>Conjugate partition: The partition we get by reading the Ferrers diagram by column instead of rows is called the <strong>conjugate</strong> of the original partition.</p>
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>. . . . . .
. . . .
. . . .
. . 
.
(6,4,4,2,1)
</pre></div>

<p>Clearly,</p>
<ul>
<li>different partitions cannot have the same conjugate, and</li>
<li>every partition of  \(n\)  is the conjugate of some partition of  \(n\) ,</li>
</ul>
<p>so the conjugation mapping is a permutation on the set of partitions of  \(n\) . This fact is very useful in proving theorems for partitions numbers.</p>
<p>Some theorems of partitions can be easily proved by representing partitions in Ferrers diagrams.</p>
<blockquote>
<p>Proposition
The number of partitions of  \(n\)  which have largest summand  \(k\) , is  \(p_k(n)\) .
The number of  \(n\)  into  \(k\)  parts equals the number of partitions of  \(n − k\)  into at most  \(k\)  parts. Formally,
$$p_k(n)=\sum_{j=1}^k p_j(n-k).$$</p>
</blockquote>
<blockquote>
<p>Proof.
For every  \(k-\) partition, the conjugate partition has largest part  \(k\) . And vice versa.
For a  \(k\) -partition of  \(n\) , remove the leftmost cell of every row of the Ferrers diagram. Totally  \(k\)  cells are removed and the remaining diagram is a partition of  \(n − k\)  into at most  \(k\)  parts. And for a partition of  \(n − k\)  into at most  \(k\)  parts, add a cell to each of the  \(k\)  rows (including the empty ones). This will give us a  \(k\) -partition of  \(n\) . It is easy to see the above mappings are 1-1 correspondences. Thus, the number of  \(n\)  into  \(k\)  parts equals the number of partitions of  \(n − k\)  into at most  \(k\)  parts.
 \(\square\) </p>
</blockquote>
<h1>The twelvfold way</h1>
<p>We now introduce a general framework for counting problems, called the <a href="https://en.wikipedia.org/wiki/Twelvefold_way">twelvefold way</a>. This framework is introduced by the great mathematician and also a great teacher, <a href="https://en.wikipedia.org/wiki/Gian-Carlo_Rota">Gian-Carlo Rota</a>.</p>
<p>Let N and M be finite sets with  \(| N | = n\)  and  \(| M | = m\) . We count the number of functions  \(f:N\rightarrow M\)  subject to different restrictions. There are three restrictions regarding the mapping  \(f\)  itself:</p>
<ol>
<li> \(f\)  is an arbitrary function;</li>
<li> \(f\)  is an injection (one-to-one);</li>
<li> \(f\)  is a surjection (onto).</li>
</ol>
<p>The elements of N and M can be regarded as <strong>distinguishable</strong> or <strong>indistinguishable</strong>. Think of  \(N\)  as a set of  \(n\)  balls and  \(M\)  as a set of  \(m\)  bins. A function  \(f:N\rightarrow M\)  is an assignment of the  \(n\)  balls into  \(m\)  bins. The balls are <em>distinguishable</em> if each ball has a <em>distinct</em> label on it, and the balls are <em>indistinguishable</em> if they are identical. The same also applies to the bins.</p>
<p>Three restrictions on the functions, with two restrictions on each of the domain and the range, together give us twelve counting problems, called the <strong>Twelvefold</strong> Way.</p>
<p>The following table gives the solutions to the counting problems.</p>
<p>Note: D = <em>distinguishable</em>, I=<em>indistinguishable</em>.</p>
<p>| N | M	 | Any f | Injective (1-1) f | Surjective (on-to) f|
| -- | -- | -- | -- | --|
| D | D |  \(m^n\)  |  \(\left(m\right)_n\)  |  \(m!\left\{{n\atop m}\right\}\,\) |
| N | D |  \(\left({m\choose n}\right)\)  |  \({m\choose n}\)  |  \({n-1\choose m-1}\) |
| D | I |  \(\sum_{k=1}^m \left\{{n\atop k}\right\}\)  |  \(\begin{cases}1 &amp; \text{if }n\le m\\ 0&amp; \text{if }n&gt;m\end{cases}\)  |  \(\left\{{n\atop m}\right\}\,\) |
| I | I |  \(\sum_{k=1}^m p_k(n)\)  |  \(\begin{cases}1 &amp; \text{if }n\le m\\ 0&amp; \text{if }n&gt;m\end{cases}\)  |  \(p_m(n)\,\) |</p>
<p>In the Volume 4A of Don Knuth&#x27;s <a href="http://www-cs-faculty.stanford.edu/~uno/taocp.html">TAOCP</a>, the twelvefold way is presented as the problems of counting the ways of assigning  \(n\)  balls into  \(m\)  bins. The domain  \(N\)  corresponds to a set of  \(n\)  balls, the range  \(M\)  corresponds to a set of  \(m\)  bins, and each function corresponds to an assignment of  \(n\)  balls into  \(m\)  bins. Balls (or bins) are distinguishable if they are <em>distinct</em> and are indistinguishable if they are <em>identical</em>. An injective function corresponds to an assignment with <em>at most</em> one ball in each bin, and a surjective function corresponds to an assignment with <em>at least</em> one ball(s) in each bin.</p>
<p>| balls per bin|	unrestricted |  \(≤ 1\)  |  \(≥ 1\)  |
| -- | -- | -- |--|
|  \(n\)  distinct balls,  \(m\)  distinct bins |  \(n\) -tuples of  \(m\)  things |  \(n\) -permutations of  \(m\)  things |partition of  \([n]\)  into  \(m\)  ordered parts|
|  \(n\)  identical balls,  \(m\)  distinct bins |  \(n\) -combinations of  \([m]\)  |  \(n\) -combinations of  \([m]\)  without repetitions | \(m\) -compositions of  \(n\) |
|  \(n\)  distinct balls,  \(m\)  identical bins | partitions of  \([n]\)  into  \(\le m\)  parts |  \(n\)  pigeons into  \(m\)  holes |partitions of  \([n]\)  into  \(m\)  parts|
|  \(n\)  identical balls,  \(m\)  identical bins | partitions of  \(n\)  into  \(\le m\)  parts |  \(n\)  pigeons into  \(m\)  holes |partitions of  \(n\)  into  \(m\)  parts|
{.small}</p>
<h1>Reference</h1>
<ul>
<li>Stanley, Enumerative Combinatorics, Volume 1, Chapter 1.</li>
</ul>
<div style="text-align: right"> Re-typesetted by  </div>
<div style="text-align: right"> [$\texttt{AUGPath}$](https://space.bilibili.com/13246364)  </div>
<div style="text-align: right"> with sincere gratitude.  </div>

    </div>

   
   
   
    <hr>






    <div id="disqus_thread"></div>
    <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML">
    </script>
    <script>
        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
        
        // var disqus_config = function () {
        // this.page.url = ;  // Replace PAGE_URL with your page's canonical URL variable
        // this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        // };
        
        (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://augpath.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <script id="dsq-count-scr" src="//augpath.disqus.com/count.js" async></script>
  </body>
</html>